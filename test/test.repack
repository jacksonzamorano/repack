snippet base {
	id uuid db:pk
	created_date datetime db:default("NOW()")
}

enum UserType #model {
	Admin
	User
	Guest
}

struct User @users #model {
	snippet:base

	last_login datetime?
	name string
	email string
	user_type UserType
	subscription_id string?


	query UserByEmail(emails: string[]) {
		list
		filter email in $emails
		sortd last_login
	}

}

aggregate UserCount User {
	count count(id)

	query UserCountByType(type: UserType) {
		list
		filter user_type = $type
	}
}


struct Token @tokens #model {
	!base
	user_id uuid ref(User.id)
}
