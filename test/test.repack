import "test-import.repack"

output description @test {
	print_commands true
}

output postgres @test/postgres #models;
output typescript_class @test/ts_classes #frontend #orm {
	make_index true
}
output typescript_interface @test/ts_interfaces #frontend {
	make_index true
}
output rust @test/rust_vanilla #frontend;


record UserPublicNoOrg: UserPublic #orm {
	*
	- org_name
	- org_id
}

record User @users #models #frontend {
	id int32 #pk #increment
	name string
	email string
	password string
	org_id ref(Organization.id)
	personal_org_id ref(Organization.id)
}

record Organization @orgs #models {
	id int32 #pk #increment
	name string
	email string
}

record UserPublic: User #orm {
	*
	org_name from(org_id.name)
	- personal_org_id
}

struct OrgModel #frontend {
	user User
}
